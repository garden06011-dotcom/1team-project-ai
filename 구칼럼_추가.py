import pandas as pd

# 파일 불러오기
file_path = "golmokSeoul_finish/data/y추가완료_카페 데이터칼럼.xlsx"
df = pd.read_excel(file_path)

# 서울시 구 코드 매핑 (행정동 앞 5자리 기준)
gu_map = {
    "11110": "종로구",
    "11140": "중구",
    "11170": "용산구",
    "11200": "성동구",
    "11215": "광진구",
    "11230": "동대문구",
    "11260": "중랑구",
    "11290": "성북구",
    "11305": "강북구",
    "11320": "도봉구",
    "11350": "노원구",
    "11380": "은평구",
    "11410": "서대문구",
    "11440": "마포구",
    "11470": "양천구",
    "11500": "강서구",
    "11530": "구로구",
    "11545": "금천구",
    "11560": "영등포구",
    "11590": "동작구",
    "11620": "관악구",
    "11650": "서초구",
    "11680": "강남구",
    "11710": "송파구",
    "11740": "강동구",
}

# 행정동코드 → 앞 5자리 → 구 매핑
df["구"] = df["행정동코드"].astype(str).str[:5].map(gu_map)

# 구가 잘 들어갔는지 확인
print(df[["행정동코드", "행정동명", "구"]].head())

# 결과 엑셀 파일로 저장 (원하면)
output_path = "golmokSeoul_finish/output/구_추가완료_카페데이터.xlsx"
df.to_excel(output_path, index=False)
output_path
